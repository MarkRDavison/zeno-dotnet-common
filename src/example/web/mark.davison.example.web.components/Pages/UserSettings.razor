@using mark.davison.common.client.abstractions.Store
@using mark.davison.common.client.web
@using mark.davison.example.web.features.Store.StartupUseCase

@attribute [Authorize]
@attribute [Route(Routes.UserSettings)]

@inherits StateComponent

@inject IStoreHelper _storeHelper

<h1>User Settings</h1>

<AuthorizeView>
	<Authorized>
		<span>@($"You are currently logged in with {context.User.FindFirst("loggedInProvider")?.Value}")</span><br />
		<span>These are all the identity providers that are linked to this account</span><br />
		<ul>
			@foreach (var linkedProvider in context.User.FindAll("provider"))
			{
				<li>@linkedProvider.Value</li>
			}
		</ul><br />
		<span>These are all the roles you have</span> <br />
		<ul>
			@foreach (var role in context.User.FindAll(ClaimTypes.Role))
			{
				<li>@role.Value</li>
			}
		</ul>
		@if (StartupState.Loaded)
		{
			<br />
			<span>These providers are configured</span>
			<ul>
				@foreach (var provider in StartupState.Data.AvailableProviders)
				{
					<li>@provider</li>
				}
			</ul>
			<br />
			<span>These roles are configured</span>
			<ul>
				@foreach (var role in StartupState.Data.Roles)
				{
					<li>@role</li>
				}
			</ul>
		}
	</Authorized>
</AuthorizeView>

@code {

	protected override void OnInitialized()
	{
		base.OnInitialized();
	}
}